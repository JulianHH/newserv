Note: this module is extremely crufty and requires a rewrite.
